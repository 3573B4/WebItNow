        protected void Page_Load(object sender, EventArgs e)
        {
            if (!Page.IsPostBack)
            {
                //Txt_Ref.Attributes.Add("onKeyPress", "doClick('" + btnSearch.ClientID + "',event)");
                GetTpoDocumento();
                Llena_ddlReferencia("**");
            }
        }        

	protected void ddlReferencias_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (ddlReferencias.SelectedValue != "-- Seleccionar --")
            { 
                TxtReferencia.Text = ddlReferencias.SelectedValue;
                GetDatosReferencia();
            }
        }

        public void TxtRef_OnTextChanged(object sender, EventArgs e)
        {
            Llena_ddlReferencia(TxtReferencia.Text);
        }

        public void Llena_ddlReferencia(string StrRef)
        {
            try
            {
                ddlReferencias.Items.Clear();

                ConexionBD conectar = new ConexionBD();
                conectar.Abrir();

                // Consulta a la tabla Tipo de Documento
                string sqlQuery = "SELECT UsReferencia " +
                                    " FROM ITM_02 " +
                                    " WHERE UsReferencia Like '" + "%" + StrRef + "%" + "'";

                SqlCommand cmd = new SqlCommand(sqlQuery, conectar.ConectarBD);
                SqlDataAdapter da = new SqlDataAdapter(cmd);
                DataTable dt = new DataTable();
                da.Fill(dt);

                ddlReferencias.Items.Insert(0, "-- Seleccionar --");
                ddlReferencias.DataSource = dt;

                ddlReferencias.DataValueField = "UsReferencia";
                ddlReferencias.DataTextField = "UsReferencia";

                ddlReferencias.DataBind();

                if (dt.Rows.Count == 0)
                {
                    ddlReferencias.Enabled = false;
                }
                else
                {
                    ddlReferencias.Enabled = true;
                }
            }
            catch (Exception ex)
            {
                LblMessage.Text = ex.Message;
                mpeMensaje.Show();
            }

        }

<%--                        
                        <div class="input-group">
                            <asp:TextBox ID="TxtReferencia" class="form-control" runat="server" OnTextChanged ="TxtRef_OnTextChanged" Style="text-transform: uppercase" AutoComplete="off" AutoPostBack="true" ></asp:TextBox>
                            <asp:DropDownList ID="ddlReferencias" runat="server" AppendDataBoundItems="true" OnSelectedIndexChanged="ddlReferencias_SelectedIndexChanged" CssClass="btn btn-light" AutoPostBack="true" >
                            </asp:DropDownList>
                        </div>
--%>

        public void OnTextChanged(object sender, EventArgs e)
        {

            Variables.wPrivilegios = System.Web.HttpContext.Current.Session["UsPrivilegios"] as string;
            //Reference the TextBox.
            TextBox textBox = sender as TextBox;

            if (TxtReferencia.Text != "")
            {

                Lbl_Message.Visible = true;

                // Insertar Registo Usuario Cargas
                int result = ValidarReferencia(TxtReferencia.Text, Int32.Parse(Variables.wPrivilegios));

                if (result == 0)
                {
                    TxtReferencia.Text = string.Empty;
                    TxtEmail.Text = string.Empty;
                    TxtNom.Text = string.Empty;

                    LblMessage.Text = "Ingrese una referencia valida";
                    this.mpeMensaje.Show();
                }
                else
                {
                    Lbl_Message.Text = "";
                    Lbl_Message.Visible = false;
                    TxtReferencia.Focus();
                }

            }
            else
            {
                Lbl_Message.Visible = true;
                Lbl_Message.Text = "* Este campo es obligatorio";
            }

        }
